agent_type: corridor
# Training parameters
max_episodes: 1000
eval_interval: 100
save_interval: 1000
num_threads: 4
num_rollouts: 1
save_dir: models
device: 1  # Use this CUDA device index (or set to auto/cpu as needed)
profile_timing: true

# Checkpoint parameters
checkpoint_interval: 99  # Save a checkpoint every 100 episodes (set to 0 to disable)
checkpoint_save_dir: checkpoints
checkpoint_save_models: true
checkpoint_save_training_state: true

# Evaluation parameters
eval_episodes: 5  # Number of episodes to run during evaluation
eval_save_results: true  # Whether to save evaluation results

# Corridor RL specific
reward_fn: diff-waiting-time
# Training monitoring: avg_speed_mps / avg_speed_norm (enable explicitly; may add overhead)
collect_speed_metrics: true
# Completely disable Corridor Agent (use only the lower-level single-objective agent)
disable_corridor_agent: true  # Set true to disable corridor agent and train single-objective only
# Disable GNN (keep observations consistent with MoLLMLight)
disable_gnn: true  # Set true to disable GNN; this will auto-disable Corridor Agent and use standard observations

# The parameters below are unused when corridor agent is disabled, but kept for config completeness
max_corridors: 3
max_corridor_length: 10
seed_top_k: 5
corridor_reward_decay: 0.9
corridor_delta_time: 50

# GNN (unused when disabled)
gnn_hidden_dim: 128
gnn_output_dim: 64
gnn_num_layers: 2
gnn_architecture: GCN
gnn_dropout: 0.1
seed_projection_dim: 64

# Grow Module (unused when disabled)
grow_hidden_dim: 128
grow_max_neighbors: 4

# Intersection Agent (single-objective mode: uses local_head only)
hidden_dim: 128
lambda_friction_coeff: 1.0
lane_feature_dim: 10
# Grow-Q -> global-critic related parameters (corridor agent disabled here; kept for consistency)
include_grow_q_in_global_critic: false
corridor_q_reduce: mean

# PPO (single-objective training; MGDA not used)
ppo_lr: 3e-4
ppo_gamma: 0.99
ppo_clip_ratio: 0.2
ppo_value_coef: 0.5
ppo_entropy_coef: 0.01
ppo_max_grad_norm: 0.5
ppo_epochs: 4
ppo_lam: 0.95
mgda_epsilon: 1e-8

